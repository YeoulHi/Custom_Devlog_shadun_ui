# 개발 일지 (Devlog)

## 2025-06-17: 글쓰기 페이지 기능 구현 및 환경 설정

### 📋 오늘의 작업 요약
- 글쓰기 페이지 기본 구조 구현
- 마크다운 에디터 컴포넌트 개발
- Supabase 연동 환경 설정
- 패키지 의존성 업데이트
- 문서 업데이트 및 Git 관리

### 🛠️ 세부 작업 내용

#### 1. 글쓰기 페이지 구현
- `app/write/page.tsx` 파일 구현
- 마크다운 에디터 UI 구성
- 포스트 제목, 내용, 태그, 카테고리 입력 폼 구현
- 미리보기 기능 추가

#### 2. 마크다운 에디터 컴포넌트 개발
- 마크다운 에디터 컴포넌트 구현
- 실시간 미리보기 기능 구현
- 마크다운 문법 하이라이팅 적용
- 툴바 기능 구현 (볼드, 이탤릭, 링크 등)

#### 3. Supabase 연동 설정
- `lib/supabase.ts` 파일 생성 및 기본 설정
- 환경 변수 설정 구조 구현
- 인증 및 데이터베이스 연동 기본 설정

#### 4. 패키지 의존성 업데이트
- 마크다운 관련 패키지 추가
- Supabase 클라이언트 패키지 추가
- 개발 의존성 패키지 업데이트

#### 5. 문서 업데이트
- `PRD/Devlog.md`: 작업 내용 기록
- `PRD/todo.md`: 글쓰기 페이지 기능 완성 체크
- 전체 진행률 업데이트

### 🔍 발생한 문제 및 해결 방법

#### 1. 마크다운 에디터 스타일링 문제
- **문제**: 마크다운 에디터와 미리보기 영역의 스타일이 일관되지 않음
- **원인**: Tailwind CSS와 마크다운 렌더러 간의 스타일 충돌
- **해결**: 커스텀 스타일 클래스 생성 및 적용, 마크다운 스타일 오버라이드

#### 2. Supabase 환경 설정 문제
- **문제**: 개발 환경과 프로덕션 환경의 설정 분리 필요
- **해결**: 환경별 설정 파일 분리 및 조건부 로딩 구현

### 💡 개선 아이디어 및 피드백

#### 개발 프로세스 개선점
1. **컴포넌트 테스트 강화**
   - 마크다운 에디터 컴포넌트의 단위 테스트 추가
   - 사용자 입력 시나리오 테스트 케이스 추가

2. **데이터 관리 최적화**
   - 글쓰기 상태 관리 로직 분리
   - 자동 저장 기능 구현 계획

#### 다음 작업 계획
- 글쓰기 페이지 기능 완성 (이미지 업로드, 태그 자동완성)
- Supabase 연동 완료 (인증, 데이터 저장)
- 검색 페이지 UI 및 기능 구현

### 📊 현재 진행 상황
- 전체 진행률: 75%
- 글쓰기 페이지: 🔄 기본 구조 구현 완료, 기능 개발 진행 중
- 다음 목표: 글쓰기 페이지 기능 완성 및 검색 페이지 구현

## 2024-06-17: 코드베이스 리팩토링 계획 수립

### 📋 오늘의 작업 요약
- 코드베이스 구조 분석 및 문제점 식별
- 리팩토링 계획 수립
- todo.md 업데이트로 리팩토링 작업 최우선 순위화
- 문서 업데이트 및 Git 관리

### 🛠️ 세부 작업 내용

#### 1. 코드베이스 분석 및 문제점 식별
- 기존 컴포넌트 구조 분석 및 일관성 문제 파악
- 클라이언트/서버 컴포넌트 혼용 문제 식별
- 중복 코드 및 불필요한 복잡성 식별
- 레이아웃 구조 일관성 부족 문제 파악

#### 2. 리팩토링 계획 수립
- 컴포넌트 구조 개선 계획 수립
  - 페이지 컴포넌트 분리 전략
  - 템플릿 컴포넌트 도입 방안
  - 컴포넌트 계층 구조 명확화 방법
- 데이터 관리 최적화 계획 수립
  - 데이터 페칭 로직 분리 방안
  - 상태 관리 전략 통일 방법
  - 타입 시스템 강화 계획
- 코드 품질 개선 계획 수립
  - 코드 스타일 통일 방안
  - 테스트 가능성 향상 전략
  - 성능 최적화 방법

#### 3. 작업 우선순위 설정
- 리팩토링 작업을 검색 페이지 구현 전 최우선 작업으로 지정
- 리팩토링 작업을 4개의 주요 하위 작업으로 분류:
  1. 컴포넌트 구조 일관성 개선
  2. 레이아웃 구조 통일
  3. 클라이언트/서버 컴포넌트 분리 최적화
  4. 공통 기능 추출 및 중복 코드 제거

#### 4. 문서 업데이트
- `PRD/todo.md`: 리팩토링 작업을 4.5단계로 추가하고 최우선 작업으로 표시
- 리팩토링 접근 방법 상세 문서화
- 코드 품질 개선을 위한 구체적인 전략 정의

### 🔍 발생한 문제 및 해결 방법

#### 1. 작업 우선순위 충돌
- **문제**: 검색 페이지 구현과 코드베이스 리팩토링 중 우선순위 결정 필요
- **해결**: 리팩토링을 먼저 진행하여 검색 페이지를 더 깔끔한 구조로 개발할 수 있도록 결정

#### 2. 리팩토링 범위 설정
- **문제**: 리팩토링 범위가 너무 넓어 작업 계획이 불명확해짐
- **해결**: 4개의 명확한 하위 작업으로 분류하고 각각에 구체적인 작업 항목 정의

### 💡 개선 아이디어 및 피드백

#### 개발 프로세스 개선점
1. **선제적 구조 설계**
   - 기능 구현 전에 컴포넌트 구조와 데이터 흐름 설계
   - 구조 설계 문서화로 일관성 유지

2. **코드 리뷰 강화**
   - 코드 리뷰 체크리스트 도입
   - 구조적 일관성 검토 항목 추가

#### 다음 작업 계획
- 컴포넌트 구조 일관성 개선 작업 시작
- 페이지 컴포넌트에서 UI 로직 분리
- 템플릿 컴포넌트 개발 및 적용

### 📊 현재 진행 상황
- 전체 진행률: 70%
- 리팩토링 작업: 🔄 계획 수립 완료, 구현 준비 중
- 다음 목표: 컴포넌트 구조 일관성 개선

## 2024-06-16: 포스트 페이지 구현 및 헤더 중복 문제 해결

### 📋 오늘의 작업 요약
- 포스트 목록 페이지 구현 완료
- 포스트 상세 페이지 구현 완료
- 헤더 중복 문제 해결
- 타입 시스템 확장
- 문서 업데이트 및 Git 관리

### 🛠️ 세부 작업 내용

#### 1. 포스트 목록 페이지 구현
- `app/posts/page.tsx` 파일 구현
- 포스트 데이터 연동 및 그리드 레이아웃 구성
- 검색 필터링 기능 구현 (제목 및 요약 기준)
- 반응형 디자인 적용 (모바일, 태블릿, 데스크톱)

#### 2. 포스트 상세 페이지 구현
- `app/posts/[slug]/page.tsx` 동적 라우팅 구현
- 포스트 데이터 로드 및 표시
- 읽기 진행률 표시 기능 구현
- 댓글 섹션 구현
- 작성자 프로필 및 관련 포스트 목록 표시

#### 3. 헤더 중복 문제 해결
- **문제**: 전역 레이아웃(`app/layout.tsx`)에 Header 컴포넌트가 포함되어 있는데, 각 페이지 컴포넌트에서도 Header를 포함하여 중복 표시됨
- **해결**: 각 페이지 컴포넌트에서 Header 컴포넌트 import와 렌더링 부분 제거
- 모든 페이지에서 헤더 표시 확인

#### 4. 타입 시스템 확장
- 관련 포스트 타입 확장
- 댓글 타입에 dislikes 필드 추가
- 데이터 모델 확장

#### 5. 문서 업데이트
- `PRD/todo.md`: 포스트 페이지 기능 완성 체크
- `README.md`: 최근 업데이트 섹션 추가
- 전체 진행률 70% 업데이트

### 🔍 발생한 문제 및 해결 방법

#### 1. 헤더 중복 문제
- **문제**: 전역 헤더와 페이지별 헤더가 중복으로 표시됨
- **원인**: 레이아웃 구조에서 헤더가 중복 정의됨
- **해결**: 페이지 컴포넌트에서 헤더 관련 코드 제거, 전역 레이아웃의 헤더만 사용

#### 2. 동적 데이터 표시 문제
- **문제**: 포스트 데이터가 일부 페이지에서 제대로 표시되지 않음
- **해결**: 'use client' 지시문 추가 및 데이터 로딩 로직 최적화

### 💡 개선 아이디어 및 피드백

#### 개발 프로세스 개선점
1. **컴포넌트 구조화**
   - 포스트 페이지의 복잡한 UI를 더 작은 컴포넌트로 분리
   - 재사용 가능한 컴포넌트 라이브러리 확장

2. **데이터 관리 최적화**
   - 서버 컴포넌트와 클라이언트 컴포넌트의 명확한 구분
   - 데이터 페칭 전략 개선

#### 다음 작업 계획
- 검색 페이지 UI 및 기능 구현
- Vercel MCP 기본 설정
- Supabase MCP 기본 설정

### 📊 현재 진행 상황
- 전체 진행률: 70%
- 완료된 페이지: 홈, 포스트, 카테고리, 태그, About, 프로젝트
- 다음 목표: 검색 페이지 구현 및 MCP 설정

## Cursor IDE 최적화 지침

### 🚀 Next.js 프로젝트 개발 시 Cursor 최적화 방안

#### 1. 개발 환경 설정
- **캐시 관리 자동화**
  ```powershell
  # 빌드 오류 발생 시 캐시 삭제 스크립트 (package.json에 추가)
  "clean": "rimraf .next && next dev"
  ```
- **에디터 설정**
  - Cursor에서 TSX/JSX 파일 저장 시 자동 포맷팅 활성화
  - 'use client' 지시문 자동 추가 스니펫 설정

#### 2. 코드 작성 워크플로우
- **컴포넌트 템플릿 활용**
  - 클라이언트/서버 컴포넌트 템플릿 미리 설정
  - 컴포넌트 생성 시 적절한 템플릿 선택

- **점진적 개발 흐름**
  1. 단일 파일 수정 → 테스트 → 커밋
  2. 연관 파일 그룹 수정 → 테스트 → 커밋
  3. 전체 기능 테스트 → 최종 커밋

#### 3. 디버깅 최적화
- **오류 로그 분석 자동화**
  - 로그 패턴 인식 및 해결책 제안 스크립트
  - 주요 오류 메시지에 대한 대응 방안 문서화

- **빠른 문제 해결 체크리스트**
  1. React 하이드레이션 오류 → 'use client' 지시문 확인
  2. 빌드 캐시 오류 → `.next` 디렉토리 삭제
  3. 컴포넌트 렌더링 오류 → props 타입 확인

#### 4. 문서화 자동화
- **커밋 메시지 템플릿**
  ```
  [페이지/컴포넌트명] 작업 내용 요약
  
  - 세부 변경사항 1
  - 세부 변경사항 2
  
  관련 이슈: #이슈번호
  ```

- **Devlog 업데이트 자동화**
  - 커밋 내역 기반 Devlog 초안 자동 생성 스크립트

#### 5. 협업 최적화
- **코드 리뷰 체크리스트**
  - 'use client' 지시문 적절한 사용
  - 불필요한 React import 제거
  - form 요소의 적절한 속성 설정
  - 타입 정의 완전성

- **브랜치 전략**
  - 기능별 브랜치 (feature/페이지명)
  - 버그 수정 브랜치 (fix/문제설명)
  - 문서 업데이트 브랜치 (docs/문서명)

### 📌 Cursor에서 자주 발생하는 Next.js 문제 해결 방법
1. **하이드레이션 불일치 오류**
   - 원인: 서버와 클라이언트 렌더링 결과 불일치
   - 해결: 조건부 렌더링에 useEffect 활용, 'use client' 지시문 추가

2. **빌드 캐시 손상**
   - 원인: 파일 시스템 오류 또는 비정상 종료
   - 해결: `.next` 디렉토리 삭제 후 재빌드

3. **타입스크립트 오류**
   - 원인: 타입 정의 불일치 또는 누락
   - 해결: 명시적 타입 정의, tsconfig.json 설정 최적화

4. **컴포넌트 import/export 오류**
   - 원인: 잘못된 경로 또는 누락된 export
   - 해결: index.ts 파일에서 일관된 export 관리

## 2024-06-18: Supabase 삽입 오류 및 레이아웃 문법 오류 디버깅

### 📋 오늘의 작업 요약
- 글쓰기 페이지 Supabase 데이터 삽입 시 발생하는 400 Bad Request 오류 집중 디버깅
- Supabase DB 스키마 문제(category 컬럼 부재) 해결
- 애플리케이션 초기 로드 시 발생하는 레이아웃 파일 문법 오류 확인

### 🛠️ 세부 작업 내용

#### 1. Supabase INSERT 오류 분석 및 디버깅
- Supabase POST 요청 시 데이터가 요청 본문(Payload)에 정상적으로 담기는 것을 확인
- 하지만 동시에 삽입하려는 컬럼 목록이 `columns` 쿼리 파라미터로 URL에 비정상적으로 추가되는 현상 파악
- Supabase API 서버가 이 비정상적인 URL 형식 때문에 400 Bad Request 오류를 반환하는 것을 확인
- 원인이 `@supabase/supabase-js` 라이브러리 버전(`^2.50.0`)의 내부 버그일 가능성이 가장 높다고 판단

#### 2. Supabase DB 스키마 문제 해결
- 글 작성 시 발생했던 `Could not find the 'category' column` 오류 분석
- Supabase 대시보드에서 `posts` 테이블에 `category` (text 타입) 컬럼이 누락된 것을 확인
- `category` 컬럼을 Supabase 대시보드에서 직접 추가하여 스키마 문제 해결 완료

#### 3. 레이아웃 파일 문법 오류 확인
- 애플리케이션 로드 시 발생하는 `Uncaught SyntaxError: Invalid or unexpected token` 오류 발견
- 오류가 컴파일된 `layout.js` 파일의 특정 위치를 가리킴
- 원본 코드(`app/layout.tsx` 또는 관련 파일)의 JavaScript 문법 오류 가능성을 파악
- Source Map을 이용해 원본 코드의 정확한 오류 위치를 찾을 필요성 확인

### 🔍 발생한 문제 및 해결 방법

#### 1. Supabase INSERT 시 400 Bad Request 오류 지속
- **문제**: 글쓰기 페이지에서 Supabase `posts` 테이블에 데이터 삽입 시 400 Bad Request 오류 발생. Network 탭 확인 결과, Payload는 정상이지만 URL에 `columns` 쿼리 파라미터가 비정상적으로 추가됨.
- **원인**: `@supabase/supabase-js` 라이브러리 버전 `^2.50.0`의 버그로 추정. 라이브러리가 POST 요청 URL을 잘못 구성하고 있음.
- **해결**: 해당 버전의 버그를 확인하거나, 라이브러리 버전 변경(다운그레이드 또는 업데이트) 또는 `.insert().select()` 체이닝 방식 변경을 시도해야 함. (해결 진행 중)

#### 2. `category` 컬럼 부재 오류
- **문제**: `posts` 테이블에 `category` 컬럼이 없어 삽입 시 오류 발생.
- **원인**: 데이터베이스 스키마에 컬럼이 누락됨.
- **해결**: Supabase 대시보드에서 `posts` 테이블에 `category` (text) 컬럼 추가 완료. (해결됨)

#### 3. `Uncaught SyntaxError` (layout.js)
- **문제**: 애플리케이션 로드 시 컴파일된 layout.js에서 문법 오류 발생.
- **원인**: 원본 코드(`app/layout.tsx` 등)에 JavaScript 문법 오류가 존재.
- **해결**: 브라우저 개발자 도구 Console 탭에서 오류 메시지를 클릭하여 Source Map으로 매핑된 원본 코드의 정확한 위치를 찾아 수정 필요. (해결 진행 중)

### 💡 개선 아이디어 및 피드백

#### 개발 프로세스 개선점
1.  **라이브러리 업데이트 주의**: 핵심 라이브러리 업데이트 시 변경 사항 및 알려진 버그를 미리 확인하는 절차 강화.
2.  **오류 발생 시 체계적 분석**: Network 탭, Console 탭, 코드 디버깅 등 단계별 분석 절차 습관화.

#### 다음 작업 계획
- Supabase 라이브러리 버전 관련 버그 정보 조사 및 버전 변경 시도.
- `app/layout.tsx` 또는 관련 파일의 문법 오류 정확한 위치 파악 및 수정.

### 📊 현재 진행 상황
- 전체 진행률: 70%
- Supabase INSERT 오류: 🔄 원인 파악 완료, 해결 시도 중
- `category` 컬럼 오류: ✅ 해결 완료
- Layout 문법 오류: �� 원인 파악 완료, 해결 시도 중
